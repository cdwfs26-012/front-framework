<div class="min-h-screen bg-black text-white p-6 sm:p-12">
  <div class="max-w-4xl mx-auto">

    <div class="flex items-center justify-between mb-12">
      <h1 class="text-4xl font-black uppercase italic tracking-tighter">Mon Panier</h1>
      <span class="bg-orange-500 text-black px-4 py-1 rounded-full text-xs font-black uppercase">
        {{ cartService.orderMode() === 'on-site' ? 'Sur Place' : 'À Emporter' }}
      </span>
    </div>

    @if (cartService.items().length > 0) {
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">

        <div class="lg:col-span-2 space-y-6">
          @for (item of cartService.items(); track item.product.reference) {
            <div class="flex items-center gap-6 bg-neutral-900/50 border border-neutral-800 p-4 rounded-[2rem]" (click)="goToDetail(item.product.url)">
              <img [src]="item.product.image" #prodImg (error)="prodImg.src = 'data/produits/placeholder.png'" class="w-20 h-20 object-cover rounded-xl bg-black">

              <div class="flex-grow">
                <h3 class="font-bold uppercase text-sm">{{ item.product.name }}</h3>
                <p class="text-orange-500 font-black">{{ item.product.prixUnitaire }}€</p>
              </div>

              <div
                (click)="$event.stopPropagation()"
                class="flex items-center gap-4 bg-black rounded-full px-4 py-2 border border-neutral-800 cursor-default">

                <button
                  (click)="updateQuantity(item.product.reference, -1)"
                  class="hover:text-orange-500 w-6 h-8 flex items-center justify-center font-bold">
                  -
                </button>

                <span class="font-bold text-xs min-w-[1.5rem] text-center">
    {{ item.quantity }}
  </span>

                <button
                  (click)="updateQuantity(item.product.reference, 1)"
                  class="hover:text-orange-500 w-6 h-8 flex items-center justify-center font-bold">
                  +
                </button>
              </div>
            </div>
          }
        </div>

        <div class="bg-neutral-900 p-8 rounded-[2.5rem] border border-neutral-800 h-fit">
          <h2 class="text-xl font-black uppercase mb-6 italic">Résumé</h2>

          <div class="space-y-4 text-sm border-b border-neutral-800 pb-6 mb-6">
            <div class="flex justify-between text-neutral-500">
              <span>Sous-total</span>
              <span>{{ subtotal() | number:'1.2-2' }}€</span>
            </div>

            @if (loginService.isLoggedIn()) {
              <div class="flex justify-between text-green-500 font-bold">
                <span>Remise Fidélité (-2%)</span>
                <span>-{{ discount() | number:'1.2-2' }}€</span>
              </div>
            } @else {
              <a routerLink="/login"
                 class="block text-[10px] text-neutral-400 hover:text-orange-500 hover:border-orange-500/50 transition-all cursor-pointer uppercase tracking-widest text-center py-3 border border-dashed border-neutral-800 rounded-lg">
                Identifiez-vous pour profiter de -2%
              </a>
            }
          </div>

          <div class="flex justify-between items-end mb-8">
            <span class="text-neutral-500 uppercase text-xs font-bold">Total TTC</span>
            <span class="text-3xl font-black text-white">{{ total() | number:'1.2-2' }}€</span>
          </div>

          <button (click)="confirmOrder()"  class="w-full bg-white text-black font-black py-5 rounded-2xl hover:bg-orange-500 hover:text-white transition-all uppercase tracking-widest text-xs">
            Payer la commande
          </button>
        </div>
      </div>
    } @else {
      <div class="text-center py-20 bg-neutral-900/20 border border-dashed border-neutral-800 rounded-[3rem]">
        <p class="text-neutral-500 italic mb-6">Votre panier est vide...</p>
        <a routerLink="/catalogue" class="text-orange-500 font-black uppercase text-sm tracking-widest">Voir la carte</a>
      </div>
    }

  </div>
</div>
